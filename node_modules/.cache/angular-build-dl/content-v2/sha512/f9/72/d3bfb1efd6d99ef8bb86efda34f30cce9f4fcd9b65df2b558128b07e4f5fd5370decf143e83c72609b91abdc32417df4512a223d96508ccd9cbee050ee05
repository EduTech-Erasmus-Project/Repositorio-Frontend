!function(){function e(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}function r(e,r){for(var t=0;t<r.length;t++){var a=r[t];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}(window.webpackJsonp=window.webpackJsonp||[]).push([[15],{lu3c:function(t,a,o){"use strict";o.r(a),o.d(a,"LoginModule",function(){return _});var i=o("ofXK"),n=o("tyNb"),s=o("mrSG"),l=o("3Pt+"),c=o("PSD3"),u=o.n(c),m=o("fXoL"),b=o("DSp3"),g=o("kyOO"),h=o("7zfz"),d=o("EFyh"),v=o("n90K"),f=o("dts7"),p=o("7kUa"),w=o("+YxP"),y=o("Ji6n"),k=o("jIHw"),O=o("sYmb");function E(e,r){1&e&&(m.Ob(0,"small",22),m.Gc(1),m.Zb(2,"translate"),m.Nb()),2&e&&(m.xb(1),m.Hc(m.ac(2,1,"login.errorMsjEmail")))}function x(e,r){1&e&&(m.Ob(0,"small",23),m.Gc(1),m.Zb(2,"translate"),m.Nb()),2&e&&(m.xb(1),m.Hc(m.ac(2,1,"login.errorMsjPassword")))}var C,M,S,F=function(e){return{"ng-dirty":e}},N=function(e,r){return{"pi-eye":e,"pi-eye-slash":r}},I=[{path:"",component:(C=function(){function t(r,a,o,i,n,s,c){e(this,t),this.auth=r,this.router=a,this.fb=o,this.languageService=i,this.messageService=n,this.loginService=s,this.storageService=c,this.subscribes=[],this.show=!1,this.loginForm=this.fb.group({email:[this.storageService.getCookieItem("userEmail")||null,[l.q.required,l.q.pattern("^([a-zA-Z0-9_'-'.]+)@([a-zA-Z0-9_'-'.]+).([a-zA-Z]{2,5})$")]],password:[null,[l.q.required]],rememberMe:[!!this.storageService.getCookieItem("userEmail")]})}var a,o,i;return a=t,(o=[{key:"ngOnDestroy",value:function(){this.subscribes.forEach(function(e){})}},{key:"ngOnInit",value:function(){var e=this;this.translate=this.languageService.translate,this.translate.onLangChange.subscribe(function(r){e.msjModal=r.translations.login.modalMsj,e.msjError={severity:"error",summary:r.translations.message.titleError,detail:r.translations.login.errorMesage}})}},{key:"errorEmailRequired",get:function(){var e;return(null===(e=this.loginForm.get("email").errors)||void 0===e?void 0:e.required)&&this.loginForm.get("email").touched}},{key:"errorEmailFormat",get:function(){var e;return(null===(e=this.loginForm.get("email").errors)||void 0===e?void 0:e.pattern)&&this.loginForm.get("email").touched}},{key:"errorPasswordRequired",get:function(){var e;return(null===(e=this.loginForm.get("password").errors)||void 0===e?void 0:e.required)&&this.loginForm.get("password").touched}},{key:"onLogin",value:function(){return Object(s.a)(this,void 0,void 0,regeneratorRuntime.mark(function e(){var r,t,a=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this.loadTranslateText(),this.messageService.clear(),!this.loginForm.valid){e.next=9;break}return u.a.fire({allowOutsideClick:!1,icon:"info",text:this.msjModal}),u.a.showLoading(),r={email:this.loginForm.get("email").value,password:this.loginForm.get("password").value},e.next=5,this.loginService.signIn(r).subscribe(function(e){return Object(s.a)(a,void 0,void 0,regeneratorRuntime.mark(function r(){var t=this;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(!e.detail){r.next=2;break}return r.abrupt("return",(this.showMessageError(),void u.a.close()));case 2:return this.storageService.saveCookieItem("data_acc",e.access),this.storageService.saveCookieItem("data_ref",e.refresh),r.next=6,this.loginService.validateUser(e.access).then(function(){var e;(null===(e=t.loginService.user)||void 0===e?void 0:e.roles.includes("teacher"))&&(console.log("Se emite"),t.loginService.characterMenu.emit(!0)),t.saveEmail(),u.a.close()}).catch(function(e){t.messageService.add({severity:"error",summary:"Server Error",detail:e}),t.showMessageError(),u.a.close()});case 6:case"end":return r.stop()}},r,this)}))},function(e){a.showMessageError(),u.a.close()});case 5:t=e.sent,this.subscribes.push(t),e.next=10;break;case 9:this.markTouchForm();case 10:case"end":return e.stop()}},e,this)}))}},{key:"markTouchForm",value:function(){Object.values(this.loginForm.controls).forEach(function(e){e.markAsTouched()})}},{key:"loadTranslateText",value:function(){var e=this.translate.currentLang;"es"===e?(this.msjModal=this.translate.translations.es.login.modalMsj,this.msjError={severity:"error",summary:this.translate.translations.es.message.titleError,detail:this.translate.translations.es.login.errorMesage}):"en"==e&&(this.msjModal=this.translate.translations.en.login.modalMsj,this.msjError={severity:"error",summary:this.translate.translations.en.message.titleError,detail:this.translate.translations.en.login.errorMesage})}},{key:"showMessageError",value:function(){this.messageService.add(this.msjError)}},{key:"onSaveEmail",value:function(e){e.checked?this.saveEmail():this.storageService.removeCookieItem("userEmail")}},{key:"saveEmail",value:function(){null!==this.loginForm.get("email").value&&""!==this.loginForm.get("email").value?this.storageService.saveCookieItem("userEmail",this.loginForm.get("email").value):(this.markTouchForm(),this.loginForm.controls.rememberMe.setValue(!1))}}])&&r(a.prototype,o),i&&r(a,i),t}(),C.\u0275fac=function(e){return new(e||C)(m.Ib(b.a),m.Ib(n.d),m.Ib(l.b),m.Ib(g.a),m.Ib(h.h),m.Ib(d.a),m.Ib(v.a))},C.\u0275cmp=m.Cb({type:C,selectors:[["app-login"]],decls:38,vars:42,consts:[[1,"login-body","layout-light"],[1,"login-content","animate__animated","animate__fadeIn"],[1,"login-panel"],[1,"login-panel-content"],[1,"logo"],["loading","lazy","src","assets/img/image2vector.svg",3,"alt"],["autocomplete","off","id","loginForm",3,"formGroup","ngSubmit"],[1,"forms"],[1,"p-field","p-fluid"],["for","email"],["aria-describedby","email-help","id","email","pInputText","","type","email","name","email","formControlName","email",3,"ngClass","placeholder"],["id","email-help","class","p-error",4,"ngIf"],["for","password"],[1,"viewPass"],["aria-describedby","pass-help","id","password","name","password","formControlName","password","pPassword","",3,"ngClass","type","placeholder","feedback"],["tabindex","0",1,"pi",3,"ngClass","click","keyup.enter"],["id","pass-help","class","p-error",4,"ngIf"],[1,"p-col-12"],["name","checked","id","check","formControlName","rememberMe","value","SaveInfo","binary","true",3,"label","onChange"],[1,"buttons"],["pButton","","type","submit",3,"label"],["href","#/restart-password",1,"secondary-button"],["id","email-help",1,"p-error"],["id","pass-help",1,"p-error"]],template:function(e,r){1&e&&(m.Ob(0,"div",0),m.Ob(1,"div",1),m.Ob(2,"div",2),m.Ob(3,"div",3),m.Ob(4,"div",4),m.Jb(5,"img",5),m.Zb(6,"translate"),m.Nb(),m.Ob(7,"h2"),m.Gc(8),m.Zb(9,"translate"),m.Nb(),m.Jb(10,"p-messages"),m.Ob(11,"form",6),m.Vb("ngSubmit",function(){return r.onLogin()}),m.Ob(12,"div",7),m.Ob(13,"div",8),m.Ob(14,"label",9),m.Gc(15),m.Zb(16,"translate"),m.Nb(),m.Jb(17,"input",10),m.Zb(18,"translate"),m.Ec(19,E,3,3,"small",11),m.Nb(),m.Ob(20,"div",8),m.Ob(21,"label",12),m.Gc(22),m.Zb(23,"translate"),m.Nb(),m.Ob(24,"div",13),m.Jb(25,"input",14),m.Zb(26,"translate"),m.Ob(27,"i",15),m.Vb("click",function(){return r.show=!r.show})("keyup.enter",function(){return r.show=!r.show}),m.Nb(),m.Nb(),m.Ec(28,x,3,3,"small",16),m.Nb(),m.Ob(29,"div",17),m.Ob(30,"p-checkbox",18),m.Vb("onChange",function(e){return r.onSaveEmail(e)}),m.Zb(31,"translate"),m.Nb(),m.Nb(),m.Ob(32,"div",19),m.Jb(33,"button",20),m.Zb(34,"translate"),m.Ob(35,"a",21),m.Gc(36),m.Zb(37,"translate"),m.Nb(),m.Nb(),m.Nb(),m.Nb(),m.Nb(),m.Nb(),m.Nb(),m.Nb()),2&e&&(m.xb(5),m.fc("alt",m.ac(6,17,"menu.altLogo")),m.xb(3),m.Hc(m.ac(9,19,"login.loginTitle")),m.xb(3),m.fc("formGroup",r.loginForm),m.xb(4),m.Hc(m.ac(16,21,"login.labeEmail")),m.xb(2),m.fc("ngClass",m.jc(35,F,r.errorEmailRequired||r.errorEmailFormat))("placeholder",m.ac(18,23,"login.placeholderEmail")),m.xb(2),m.fc("ngIf",r.errorEmailRequired||r.errorEmailFormat),m.xb(3),m.Hc(m.ac(23,25,"login.labelPassword")),m.xb(3),m.fc("ngClass",m.jc(37,F,r.errorPasswordRequired))("type",r.show?"text":"password")("placeholder",m.ac(26,27,"login.placeholderPass"))("feedback",!1),m.xb(2),m.fc("ngClass",m.kc(39,N,!r.show,r.show)),m.xb(1),m.fc("ngIf",r.errorPasswordRequired),m.xb(2),m.fc("label",m.ac(31,29,"login.check")),m.xb(3),m.fc("label",m.ac(34,31,"login.btnLogin")),m.xb(3),m.Ic("",m.ac(37,33,"login.recoverPassword")," "))},directives:[f.a,l.r,l.l,l.f,l.a,p.a,l.k,l.e,i.j,i.l,w.a,y.a,k.b],pipes:[O.c],styles:[".login-content[_ngcontent-%COMP%]{position:relative;height:100vh}.login-content[_ngcontent-%COMP%]   .desert[_ngcontent-%COMP%]{position:absolute;bottom:0}.login-content[_ngcontent-%COMP%]   .login-panel[_ngcontent-%COMP%]{height:100%}.viewPass[_ngcontent-%COMP%]{position:relative}.viewPass[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{position:absolute;top:8px;right:10px;padding:5px;cursor:pointer}"]}),C),data:{breadcrumb:null}}],P=((M=function r(){e(this,r)}).\u0275mod=m.Gb({type:M}),M.\u0275inj=m.Fb({factory:function(e){return new(e||M)},imports:[[n.h.forChild(I)],n.h]}),M),j=o("PCNd"),_=((S=function r(){e(this,r)}).\u0275mod=m.Gb({type:S}),S.\u0275inj=m.Fb({factory:function(e){return new(e||S)},imports:[[i.b,P,l.o,j.a]]}),S)}}])}();