<ng-container *ngIf="loading; else loadingTemplate">
        <div class="spinner animate__animated animate__fadeIn">
                <p-progressSpinner [style]="{width: '100px', height: '100px'}" styleClass="custom-spinner"
                        strokeWidth="4" fill="#EEEEEE" animationDuration=".5s"></p-progressSpinner>
        </div>
</ng-container>
<ng-template #loadingTemplate>

        <p-fileUpload name="file" [url]="baseUrl" [chooseLabel]="'newObject.form.imgSelect' | translate"
                [cancelLabel]="'newObject.form.imgCancel' | translate"
                [uploadLabel]="'newObject.form.fileUpload' | translate" (onUpload)="onUpload($event)"
                (onError)="onError($event)" [invalidFileTypeMessageDetail]="'newObject.errors.img' | translate"
                [multiple]="false" accept=".zip,.rar">
                <ng-template pTemplate="content">
                        <ng-container *ngIf="file">
                                <p>{{file.name}} - {{file.size}}</p>
                                <!-- <a [href]="objectUrl" target="_blank">Previsualizar</a> -->
                                <p-button (click)="navigate()" icon="pi pi-external-link"
                                        [label]="'newObject.form.btnPreview' | translate">
                                </p-button>
                                <p-button [style]="{margin: '0 5px'}" (click)="showBasicDialog2()"
                                        icon="pi pi-external-link"
                                        [label]="'newObject.form.btnShowMetadata' | translate">
                                </p-button>
                        </ng-container>
                </ng-template>
        </p-fileUpload>

        <ng-container *ngIf="object; else dataTemplate">

                <p-dialog [header]="object.general_title" [(visible)]="displayWindow" [style]="{width: '50vw'}"
                        [baseZIndex]="10000">

                        <app-metadata *ngIf="object" [learningobjectdetail]="object"></app-metadata>

                        <ng-template pTemplate="footer">
                                <p-button icon="pi pi-check" (click)="displayWindow=false" label="Ok"
                                        styleClass="p-button-text"></p-button>
                        </ng-template>
                </p-dialog>



                <form class="animate__animated animate__fadeIn" [formGroup]="objectForm" (ngSubmit)="onSubmit()">

                        <div class="p-field p-fluid">
                                <label for="title">{{'newObject.form.titleLabel' | translate}}*</label>
                                <input [ngClass]="{'ng-dirty': getErrorFormRequired('title')}"
                                        aria-describedby="title-help" pInputText type="text" formControlName="title"
                                        [placeholder]="'newObject.form.title' | translate" id="title" />
                                <small *ngIf="getErrorFormRequired('title')" id="title-help"
                                        class="p-error">{{'newObject.errors.title' | translate}}</small>
                        </div>

                        <div class="p-field p-fluid">
                                <label for="description">{{'newObject.form.descriptionLabel' | translate}}*</label>
                                <textarea rows="10" [ngClass]="{'ng-dirty': getErrorFormRequired('description')}"
                                        pInputTextarea formControlName="description" id="description"
                                        aria-describedby="description-help"
                                        [placeholder]="'newObject.form.description' | translate"></textarea>

                                <small *ngIf="getErrorFormRequired('description')" id="description-help"
                                        class="p-error">{{'newObject.errors.description' | translate}}</small>
                        </div>

                        <div class="p-field p-fluid">
                                <label for="keywords">{{'newObject.form.keywordsLabel' | translate}}*</label>
                                <input [ngClass]="{'ng-invalid ng-dirty': getErrorFormRequired('keywords')}"
                                        aria-describedby="keywords-help" pInputText type="text"
                                        formControlName="keywords" id="keywords"
                                        [placeholder]="'newObject.form.keywords' | translate" />

                                <small *ngIf="getErrorFormRequired('keywords')" id="keywords-help"
                                        class="p-error">{{'newObject.errors.keywords' | translate}} </small>
                        </div>

                        <div class="p-grid">
                                <div class="p-col-12 p-md-6 p-lg-6">
                                        <div class="box sidebar">
                                                <div class="p-field p-fluid">
                                                        <label for="level">{{'newObject.form.educationLevelLabel' |
                                                                translate}}*</label>
                                                        <p-dropdown
                                                                [ngClass]="{'ng-invalid ng-dirty': getErrorFormRequired('education_levels')}"
                                                                id="language" [options]="educationLevels"
                                                                fromControlName="education_levels"
                                                                aria-describedby="level-help"
                                                                (onChange)="selectLevel($event)"
                                                                [placeholder]="'newObject.form.educationLevel' | translate"
                                                                optionLabel="name" [showClear]="true">
                                                        </p-dropdown>
                                                        <small *ngIf="getErrorFormRequired('education_levels')"
                                                                id="level-help"
                                                                class="p-error">{{'newObject.errors.educationLevel' |
                                                                translate}}</small>
                                                </div>
                                        </div>
                                </div>
                                <div class="p-col-12 p-md-6 p-lg-6">
                                        <div class="box sidebar">
                                                <div class="p-field p-fluid">
                                                        <label for="language">{{'newObject.form.languageLabel' |
                                                                translate}}*</label>
                                                        <p-dropdown
                                                                [ngClass]="{'ng-invalid ng-dirty': getErrorFormRequired('language')}"
                                                                id="language" [options]="language"
                                                                fromControlName="language"
                                                                aria-describedby="language-help"
                                                                (onChange)="selectLanguage($event)"
                                                                [placeholder]="'newObject.form.language' | translate"
                                                                optionLabel="name" [showClear]="true">
                                                        </p-dropdown>
                                                        <small *ngIf="getErrorFormRequired('language')"
                                                                id="language-help"
                                                                class="p-error">{{'newObject.errors.language' |
                                                                translate}}</small>
                                                </div>
                                        </div>
                                </div>
                        </div>

                        <div class="p-grid">
                                <div class="p-col-12 p-md-6 p-lg-6">
                                        <div class="box sidebar">
                                                <div class="p-field p-fluid">
                                                        <label for="knowledgeArea">{{'newObject.form.knowledgeAreaLabel'|
                                                                translate}}*</label>
                                                        <p-dropdown
                                                                [ngClass]="{'ng-invalid ng-dirty': getErrorFormRequired('knowledge_area')}"
                                                                id="knowledgeArea" [options]="knowledgeArea"
                                                                fromControlName="knowledge_area"
                                                                aria-describedby="knowledge_area"
                                                                (onChange)="selectKnowledgeArea($event)"
                                                                [placeholder]="'newObject.form.knowledgeArea' | translate"
                                                                optionLabel="name" [showClear]="true">
                                                        </p-dropdown>
                                                        <small *ngIf="getErrorFormRequired('knowledge_area')"
                                                                id="knowledgeArea-help"
                                                                class="p-error">{{'newObject.errors.knowledgeArea' |
                                                                translate}}</small>
                                                </div>
                                        </div>
                                </div>
                                <div class="p-col-12 p-md-6 p-lg-6">
                                        <div class="box sidebar">
                                                <div class="p-field p-fluid">
                                                        <label for="license">{{'newObject.form.licenseLabel' |
                                                                translate}}*</label>
                                                        <p-dropdown
                                                                [ngClass]="{'ng-invalid ng-dirty': getErrorFormRequired('license')}"
                                                                id="license" [options]="licenses"
                                                                fromControlName="license"
                                                                aria-describedby="license-help"
                                                                (onChange)="selectLicense($event)"
                                                                [placeholder]="'newObject.form.license' | translate"
                                                                optionLabel="name" [showClear]="true">
                                                        </p-dropdown>
                                                        <small *ngIf="getErrorFormRequired('license')" id="license-help"
                                                                class="p-error">{{'newObject.errors.license' |
                                                                translate}}</small>
                                                </div>
                                        </div>
                                </div>
                        </div>

                        <div class="p-grid">

                                <div class="p-col-12 p-md-6 p-lg-6">
                                        <div class="box content">
                                                <div class="p-field p-fluid slider">
                                                        <label for="Correo">{{'newObject.form.ageLabel' | translate}}:
                                                                {{objectForm.controls.age?.value[0] +' - '+
                                                                objectForm.controls.age?.value[1]}}</label>
                                                        <p-slider [min]="5" [max]="150" formControlName="age"
                                                                [range]="true">
                                                        </p-slider>
                                                </div>
                                        </div>
                                </div>
                                <div class="p-col-12 p-md-6 p-lg-6">
                                        <div class="box sidebar">
                                                <div class="p-field p-fluid" tabindex="0">
                                                        <label for="adaptations">Objeto de aprendizaje adaptado*</label>
                                                        <br />
                                                        <div class="radio-buttons">
                                                                <div class="p-field-radiobutton">
                                                                        <p-radioButton
                                                                                [ngClass]="{'ng-dirty': getErrorFormRequired('adaptations')}"
                                                                                aria-describedby="adaptations-help"  
                                                                                name="adaptations" value="yes"
                                                                                formControlName="adaptations"
                                                                                inputId="yes">
                                                                        </p-radioButton>
                                                                        <label for="yes">{{'newObject.form.adaptationsYes'
                                                                                | translate}}</label>
                                                                </div>
                                                                <div class="p-field-radiobutton">
                                                                        <p-radioButton
                                                                                [ngClass]="{'ng-dirty': getErrorFormRequired('adaptations')}"
                                                                                aria-describedby="adaptations-help"
                                                                                name="adaptations" value="no"
                                                                                formControlName="adaptations"
                                                                                inputId="no">
                                                                        </p-radioButton>
                                                                        <label for="no">{{'newObject.form.adaptationsNo'
                                                                                | translate}}</label>
                                                                </div>
                                                        </div>
                                                        <label for="" *ngIf="is_adapted_oer == true">Este objeto de
                                                                aprendizaje fue adaptado con la herramienta <a
                                                                        style="font-style: italic;text-decoration: underline;"
                                                                        href="https://oeradap.edutech-project.org/">OER-ADAP</a></label>
                                                        <label for="" *ngIf="is_adapted_oer == false">Visita nuestra
                                                                herramienta <a
                                                                        style="font-style: italic;text-decoration: underline;"
                                                                        href="https://oeradap.edutech-project.org/">OER-ADAP</a>
                                                                para la adaptación de objetos de aprendizaje.También
                                                                visita nuestra herramienta <a
                                                                        style="font-style: italic;text-decoration: underline;"
                                                                        href="https://lompads.edutech-project.org/#/">LOMPAD-WEB</a>
                                                                para el metaetiquetado para objetos de
                                                                aprendizaje.</label>

                                                </div>
                                        </div>
                                </div>
                        </div>

                        <div class="p-field p-fluid">
                                <label for="fileImage">{{'newObject.form.imgLabel' | translate}}*</label>
                                <p-fileUpload id="fileImage" name="fileImage"
                                        [chooseLabel]="'newObject.form.imgSelect' | translate"
                                        [showUploadButton]="false"
                                        [cancelLabel]="'newObject.form.imgCancel' | translate"
                                        (onSelect)="onSelectImage($event)"
                                        [invalidFileTypeMessageDetail]="'newObject.errors.img' | translate"
                                        [multiple]="false" accept="image/*" aria-describedby="img-help">
                                </p-fileUpload>
                                <small *ngIf="getErrorFormRequired('img')" id="img-help"
                                        class="p-error">{{'newObject.errors.imgHelp' |
                                        translate}}</small>
                        </div>

                        <div class="p-field p-fluid">
                                <label for="fileImage">Fichero fuente eXeLearning</label>
                                <p-fileUpload id="fileImage" name="fileImage"
                                        [chooseLabel]="'newObject.form.imgSelect' | translate"
                                        [showUploadButton]="false"
                                        [cancelLabel]="'newObject.form.imgCancel' | translate"
                                        (onSelect)="onSelectFile($event)"
                                        [invalidFileTypeMessageDetail]="'newObject.errors.img' | translate"
                                        [multiple]="false" accept=".elp" aria-describedby="img-help">
                                </p-fileUpload>

                        </div>
                        <div class="content_questions" *ngIf="is_adapted_oer == false">
                                <div class="p-grid" *ngIf="tag_count.img != 0">
                                        <div class="p-col-12 p-md-6 p-lg-6">
                                                <div class="box content">
                                                        <div class="p-field p-fluid slider">
                                                                <label for="Pregunta1" class="preguntas-metadatos">¿Ha
                                                                        considerado poner texto alternativo en las
                                                                        imágenes que así lo requieran?*</label>
                                                                <label for="Resp">Se encontraron un total de
                                                                        {{tag_count.img}} imagenes.</label>
                                                                <br>
                                                                <div class="radio-buttons">
                                                                        <div class="p-field-radiobutton">
                                                                                <p-radioButton
                                                                                        [ngClass]="{'ng-dirty': getErrorFormRequired('item_v1')}"
                                                                                        aria-describedby="Pregunta numero 1"
                                                                                        name="item_v1" value="yes"
                                                                                        formControlName="item_v1"
                                                                                        inputId="yes">
                                                                                </p-radioButton>
                                                                                <label for="yes">{{'newObject.form.adaptationsYes'
                                                                                        | translate}}</label>
                                                                        </div>
                                                                        <div class="p-field-radiobutton">
                                                                                <p-radioButton
                                                                                        [ngClass]="{'ng-dirty': getErrorFormRequired('item_v1')}"
                                                                                        aria-describedby="item_v1-help"
                                                                                        name="item_v1" value="no"
                                                                                        formControlName="item_v1"
                                                                                        inputId="no">
                                                                                </p-radioButton>
                                                                                <label for="no">{{'newObject.form.adaptationsNo'
                                                                                        | translate}}</label>
                                                                        </div>
                                                                </div>
                                                                <small *ngIf="getErrorFormRequired('item_v1')"
                                                                        id="item_v1-help" class="p-error">Por favor
                                                                        seleccione una opción</small>
                                                        </div>
                                                </div>
                                        </div>


                                        <div class="p-col-12 p-md-6 p-lg-6">
                                                <div class="box content">
                                                        <div class="p-field p-fluid slider">
                                                                <label for="Pregunta1" class="preguntas-metadatos">¿Se
                                                                        cumple con contrastes óptimos en la presentación
                                                                        de la información?*</label>

                                                                <br>
                                                                <div class="radio-buttons">
                                                                        <div class="p-field-radiobutton">
                                                                                <p-radioButton
                                                                                        [ngClass]="{'ng-dirty': getErrorFormRequired('item_v2')}"
                                                                                        aria-describedby="adaptations-help"
                                                                                        name="item_v2" value="yes"
                                                                                        formControlName="item_v2"
                                                                                        inputId="yes">
                                                                                </p-radioButton>
                                                                                <label for="yes">{{'newObject.form.adaptationsYes'
                                                                                        | translate}}</label>
                                                                        </div>
                                                                        <div class="p-field-radiobutton">
                                                                                <p-radioButton
                                                                                        [ngClass]="{'ng-dirty': getErrorFormRequired('item_v2')}"
                                                                                        aria-describedby="adaptations-help"
                                                                                        name="item_v2" value="no"
                                                                                        formControlName="item_v2"
                                                                                        inputId="no">
                                                                                </p-radioButton>
                                                                                <label for="no">{{'newObject.form.adaptationsNo'
                                                                                        | translate}}</label>
                                                                        </div>
                                                                </div>
                                                                <small *ngIf="getErrorFormRequired('item_v2')"
                                                                        id="item_v2-help" class="p-error">Por favor
                                                                        seleccione una opción</small>
                                                        </div>
                                                </div>
                                        </div>
                                </div>

                                <div class="p-grid" *ngIf="tag_count.paragraph != 0">
                                        <div class="p-col-12 p-md-6 p-lg-6">
                                                <div class="box content">
                                                        <div class="p-field p-fluid slider">
                                                                <label for="Pregunta1" class="preguntas-metadatos">¿El
                                                                        contenido textual contiene títulos,
                                                                        descripciones o enlaces adecuados?*</label>
                                                                <label for="Resp">Se encontraron un total de
                                                                        {{tag_count.paragraph}} parrafos.</label>
                                                                <br>
                                                                <div class="radio-buttons">
                                                                        <div class="p-field-radiobutton">
                                                                                <p-radioButton
                                                                                        [ngClass]="{'ng-dirty': getErrorFormRequired('item_t3')}"
                                                                                        aria-describedby="adaptations-help"
                                                                                        name="item_t3" value="yes"
                                                                                        formControlName="item_t3"
                                                                                        inputId="yes">
                                                                                </p-radioButton>
                                                                                <label for="yes">{{'newObject.form.adaptationsYes'
                                                                                        | translate}}</label>
                                                                        </div>
                                                                        <div class="p-field-radiobutton">
                                                                                <p-radioButton
                                                                                        [ngClass]="{'ng-dirty': getErrorFormRequired('item_t3')}"
                                                                                        aria-describedby="adaptations-help"
                                                                                        name="item_t3" value="no"
                                                                                        formControlName="item_t3"
                                                                                        inputId="no">
                                                                                </p-radioButton>
                                                                                <label for="no">{{'newObject.form.adaptationsNo'
                                                                                        | translate}}</label>
                                                                        </div>
                                                                </div>
                                                                <small *ngIf="getErrorFormRequired('item_t3')"
                                                                        id="item_t3-help" class="p-error">Por favor
                                                                        seleccione una opción</small>
                                                        </div>
                                                </div>
                                        </div>


                                        <div class="p-col-12 p-md-6 p-lg-6">
                                                <div class="box content">
                                                        <div class="p-field p-fluid slider">
                                                                <label for="Pregunta1" class="preguntas-metadatos">¿Se
                                                                        cumple con contrastes óptimos en la presentación
                                                                        del contenido de texto y fondo?*</label>
                                                                <br>
                                                                <div class="radio-buttons">
                                                                        <div class="p-field-radiobutton">
                                                                                <p-radioButton
                                                                                        [ngClass]="{'ng-dirty': getErrorFormRequired('item_t4')}"
                                                                                        aria-describedby="adaptations-help"
                                                                                        name="item_t4" value="yes"
                                                                                        formControlName="item_t4"
                                                                                        inputId="yes">
                                                                                </p-radioButton>
                                                                                <label for="yes">{{'newObject.form.adaptationsYes'
                                                                                        | translate}}</label>
                                                                        </div>
                                                                        <div class="p-field-radiobutton">
                                                                                <p-radioButton
                                                                                        [ngClass]="{'ng-dirty': getErrorFormRequired('item_t4')}"
                                                                                        aria-describedby="adaptations-help"
                                                                                        name="item_t4" value="no"
                                                                                        formControlName="item_t4"
                                                                                        inputId="no">
                                                                                </p-radioButton>
                                                                                <label for="no">{{'newObject.form.adaptationsNo'
                                                                                        | translate}}</label>
                                                                        </div>
                                                                </div>
                                                                <small *ngIf="getErrorFormRequired('item_t4')"
                                                                        id="item_t4-help" class="p-error">Por favor
                                                                        seleccione una opción</small>
                                                        </div>
                                                </div>
                                        </div>
                                </div>
                                <div class="p-grid">
                                        <div class="p-col-12 p-md-6 p-lg-6"
                                                *ngIf="tag_count.video != 0 || tag_count.audio != 0">
                                                <div class="box content">
                                                        <div class="p-field p-fluid slider">
                                                                <label for="Pregunta1" class="preguntas-metadatos">¿Los
                                                                        videos contienen subtitulado sincronizado y
                                                                        coherente con el lenguaje?*</label>
                                                                <label for="Resp">Se encontraron un total de
                                                                        {{tag_count.video}} videos.</label>
                                                                <br>
                                                                <label for="Resp">Se encontraron un total de
                                                                        {{tag_count.audio}} audios.</label>
                                                                <br>
                                                                <div class="radio-buttons">
                                                                        <div class="p-field-radiobutton">
                                                                                <p-radioButton
                                                                                        [ngClass]="{'ng-dirty': getErrorFormRequired('item_a5')}"
                                                                                        aria-describedby="adaptations-help"
                                                                                        name="item_a5" value="yes"
                                                                                        formControlName="item_a5"
                                                                                        inputId="yes">
                                                                                </p-radioButton>
                                                                                <label for="yes">{{'newObject.form.adaptationsYes'
                                                                                        | translate}}</label>
                                                                        </div>
                                                                        <div class="p-field-radiobutton">
                                                                                <p-radioButton
                                                                                        [ngClass]="{'ng-dirty': getErrorFormRequired('item_a5')}"
                                                                                        aria-describedby="adaptations-help"
                                                                                        name="item_a5" value="no"
                                                                                        formControlName="item_a5"
                                                                                        inputId="no">
                                                                                </p-radioButton>
                                                                                <label for="no">{{'newObject.form.adaptationsNo'
                                                                                        | translate}}</label>
                                                                        </div>
                                                                </div>
                                                                <small *ngIf="getErrorFormRequired('item_a5')"
                                                                        id="item_a5-help" class="p-error">Por favor
                                                                        seleccione una opción</small>
                                                        </div>
                                                </div>
                                        </div>

                                        <div class="p-col-12 p-md-6 p-lg-6">
                                                <div class="box content">
                                                        <div class="p-field p-fluid slider">
                                                                <label for="Pregunta1" class="preguntas-metadatos">¿Se
                                                                        puede navegar secuencialmente sobre el contenido
                                                                        utilizando únicamente el teclado?*</label>
                                                                <br>
                                                                <div class="radio-buttons">
                                                                        <div class="p-field-radiobutton">
                                                                                <p-radioButton
                                                                                        [ngClass]="{'ng-dirty': getErrorFormRequired('item_i6')}"
                                                                                        aria-describedby="adaptations-help"
                                                                                        name="item_i6" value="yes"
                                                                                        formControlName="item_i6"
                                                                                        inputId="yes">
                                                                                </p-radioButton>
                                                                                <label for="yes">{{'newObject.form.adaptationsYes'
                                                                                        | translate}}</label>
                                                                        </div>
                                                                        <div class="p-field-radiobutton">
                                                                                <p-radioButton
                                                                                        [ngClass]="{'ng-dirty': getErrorFormRequired('item_i6')}"
                                                                                        aria-describedby="adaptations-help"
                                                                                        name="item_i6" value="no"
                                                                                        formControlName="item_i6"
                                                                                        inputId="no">
                                                                                </p-radioButton>
                                                                                <label for="no">{{'newObject.form.adaptationsNo'
                                                                                        | translate}}</label>
                                                                        </div>
                                                                </div>
                                                                <small *ngIf="getErrorFormRequired('item_i6')"
                                                                        id="item_i6-help" class="p-error">Por favor
                                                                        seleccione una opción</small>
                                                        </div>
                                                </div>
                                        </div>
                                </div>
                        </div>
                        <p-button type="submit" title="Guardar" [label]="'newObject.form.btnSubmit' | translate">
                        </p-button>
                </form>
        </ng-container>
        <ng-template #dataTemplate>
                <h4>{{'newObject.infoLoadFile' | translate}}</h4>
                <label>Recuerda que los estándares educativos de objetos de aprendizaje aceptados por el repositorio son
                        IMS Y SCROM.</label>
        </ng-template>

</ng-template>

<p-toast></p-toast>