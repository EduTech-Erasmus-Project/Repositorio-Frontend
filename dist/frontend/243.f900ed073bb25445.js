"use strict";(self.webpackChunkmirage=self.webpackChunkmirage||[]).push([[243],{3807:(Z,c,t)=>{t.d(c,{K:()=>w});var d=t(6895),u=t(380),g=t(4006),n=t(2466),m=t(5030),p=t(4298),s=t(6738);let w=(()=>{class l{static#s=this.\u0275fac=function(_){return new(_||l)};static#a=this.\u0275mod=s.oAB({type:l});static#r=this.\u0275inj=s.cJS({imports:[d.ez,u.m,g.UX,n.aw,m.Y,p.S]})}return l})()},5243:(Z,c,t)=>{t.r(c),t.d(c,{SecurityModule:()=>j});var d=t(6895),u=t(7935),g=t(5861),n=t(4006),m=t(5226),p=t.n(m),s=t(6738),w=t(4120),l=t(2111),A=t(8253),h=t(1155),_=t(8611),y=t(2778),x=t(8473),C=t(9723),b=t(2466);function O(r,i){1&r&&(s.TgZ(0,"small",27),s._uU(1),s.ALo(2,"translate"),s.qZA()),2&r&&(s.xp6(1),s.hij("*",s.lcZ(2,1,"validation.obligatoryCamp"),"*"))}function P(r,i){if(1&r&&(s.TgZ(0,"div"),s.YNc(1,O,3,3,"small",26),s.qZA()),2&r){const a=s.oxw(2);s.xp6(1),s.Q6J("ngIf",a.passwordOld.errors.required)}}function T(r,i){1&r&&(s.TgZ(0,"small",28),s._uU(1),s.ALo(2,"translate"),s.qZA()),2&r&&(s.xp6(1),s.hij("*",s.lcZ(2,1,"security.passError"),"*"))}function N(r,i){1&r&&(s.TgZ(0,"small",32),s._uU(1),s.ALo(2,"translate"),s.qZA()),2&r&&(s.xp6(1),s.hij("*",s.lcZ(2,1,"validation.obligatoryCamp"),"*"))}function S(r,i){1&r&&(s.TgZ(0,"small",33),s._uU(1),s.ALo(2,"translate"),s.TgZ(3,"ul",34)(4,"li"),s._uU(5),s.ALo(6,"translate"),s.qZA(),s.TgZ(7,"li"),s._uU(8),s.ALo(9,"translate"),s.qZA(),s.TgZ(10,"li"),s._uU(11),s.ALo(12,"translate"),s.qZA(),s.TgZ(13,"li"),s._uU(14),s.ALo(15,"translate"),s.qZA()()()),2&r&&(s.xp6(1),s.hij("*",s.lcZ(2,5,"validation.passwordEnter"),"* "),s.xp6(4),s.Oqu(s.lcZ(6,7,"validation.passDigit")),s.xp6(3),s.Oqu(s.lcZ(9,9,"validation.passMinu")),s.xp6(3),s.Oqu(s.lcZ(12,11,"validation.passMayu")),s.xp6(3),s.Oqu(s.lcZ(15,13,"validation.passChar")))}function E(r,i){1&r&&(s.TgZ(0,"small",35),s._uU(1,"*La contrase\xf1a no puede ser la misma que la anterior*"),s.qZA())}function I(r,i){if(1&r&&(s.TgZ(0,"div"),s.YNc(1,N,3,3,"small",29),s.YNc(2,S,16,15,"small",30),s.YNc(3,E,2,0,"small",31),s.qZA()),2&r){const a=s.oxw(2);s.xp6(1),s.Q6J("ngIf",a.passwordNew.errors.required),s.xp6(1),s.Q6J("ngIf",a.passwordNew.errors.pattern),s.xp6(1),s.Q6J("ngIf",a.passsword_invalid)}}function L(r,i){1&r&&(s.TgZ(0,"small",37),s._uU(1),s.ALo(2,"translate"),s.qZA()),2&r&&(s.xp6(1),s.hij("*",s.lcZ(2,1,"validation.obligatoryCamp"),"*"))}function F(r,i){if(1&r&&(s.TgZ(0,"div"),s.YNc(1,L,3,3,"small",36),s.qZA()),2&r){const a=s.oxw(2);s.xp6(1),s.Q6J("ngIf",a.passwordAgain.errors.required)}}function U(r,i){1&r&&(s.TgZ(0,"small",38),s._uU(1),s.ALo(2,"translate"),s.qZA()),2&r&&(s.xp6(1),s.Oqu(s.lcZ(2,1,"security.confirmPassError")))}function M(r,i){1&r&&(s.TgZ(0,"small",39),s._uU(1,"*La contrase\xf1a no puede ser la misma que la anterior*"),s.qZA())}const v=function(r){return{"ng-dirty ng-invalid":r}},J=function(r,i){return{"pi-eye":r,"pi-eye-slash":i}};function q(r,i){if(1&r){const a=s.EpF();s.TgZ(0,"div",1)(1,"div",2)(2,"div",11)(3,"label",12),s._uU(4),s.ALo(5,"translate"),s.qZA()(),s._UZ(6,"br"),s.TgZ(7,"div",11)(8,"label",12),s._uU(9),s.ALo(10,"translate"),s.qZA()(),s._UZ(11,"br"),s.TgZ(12,"div",11)(13,"label",12),s._uU(14),s.ALo(15,"translate"),s.qZA()(),s._UZ(16,"br"),s.qZA(),s.TgZ(17,"div",2)(18,"form",13),s.NdJ("ngSubmit",function(){s.CHM(a);const e=s.oxw();return s.KtG(e.sendPasswordRest())}),s.TgZ(19,"div",11)(20,"div",14),s._UZ(21,"input",15),s.ALo(22,"translate"),s.TgZ(23,"i",16),s.NdJ("click",function(){s.CHM(a);const e=s.oxw();return s.KtG(e.show2=!e.show2)})("keyup.enter",function(){s.CHM(a);const e=s.oxw();return s.KtG(e.show2=!e.show2)}),s.qZA()(),s.YNc(24,P,2,1,"div",17),s.YNc(25,T,3,3,"small",18),s.qZA(),s._UZ(26,"br"),s.TgZ(27,"div",11)(28,"input",19),s.NdJ("keypress",function(){s.CHM(a);const e=s.oxw();return s.KtG(e.enabled_Password())}),s.ALo(29,"translate"),s.qZA(),s.YNc(30,I,4,3,"div",17),s.qZA(),s._UZ(31,"br"),s.TgZ(32,"div",11)(33,"input",20),s.NdJ("keyup",function(){s.CHM(a);const e=s.oxw();return s.KtG(e.validatorPassword())}),s.ALo(34,"translate"),s.qZA(),s.YNc(35,F,2,1,"div",17),s.YNc(36,U,3,3,"small",21),s.YNc(37,M,2,0,"small",22),s.qZA(),s._UZ(38,"br"),s.TgZ(39,"div",11)(40,"div",23)(41,"button",24),s.NdJ("click",function(){s.CHM(a);const e=s.oxw();return s.KtG(e.resetForm())}),s.qZA(),s._uU(42," \xa0 "),s._UZ(43,"button",25),s.ALo(44,"translate"),s.qZA()()()()()}if(2&r){const a=s.oxw();s.xp6(4),s.Oqu(s.lcZ(5,19,"security.oldPass")),s.xp6(5),s.Oqu(s.lcZ(10,21,"security.newPass")),s.xp6(5),s.Oqu(s.lcZ(15,23,"security.againNewPass")),s.xp6(4),s.Q6J("formGroup",a.angForm),s.xp6(3),s.s9C("placeholder",s.lcZ(22,25,"security.oldPass")),s.Q6J("type",a.show2?"text":"password")("ngClass",s.VKq(33,v,a.passwordOld.invalid&&(a.passwordOld.dirty||a.passwordOld.touched)||a.passError)),s.xp6(2),s.Q6J("ngClass",s.WLB(35,J,!a.show2,a.show2)),s.xp6(1),s.Q6J("ngIf",a.passwordOld.invalid&&(a.passwordOld.dirty||a.passwordOld.touched)),s.xp6(1),s.Q6J("ngIf",a.passError),s.xp6(3),s.s9C("placeholder",s.lcZ(29,27,"security.newPass")),s.Q6J("ngClass",s.VKq(38,v,a.passwordNew.invalid&&(a.passwordNew.dirty||a.passwordNew.touched)||a.passsword_invalid)),s.xp6(2),s.Q6J("ngIf",a.passwordNew.invalid&&(a.passwordNew.dirty||a.passwordNew.touched)),s.xp6(3),s.s9C("placeholder",s.lcZ(34,29,"security.againNewPass")),s.Q6J("ngClass",s.VKq(40,v,a.passwordAgain.invalid&&(a.passwordAgain.dirty||a.passwordAgain.touched)||a.passsword_invalid)),s.xp6(2),s.Q6J("ngIf",a.passwordAgain.invalid&&(a.passwordAgain.dirty||a.passwordAgain.touched)),s.xp6(1),s.Q6J("ngIf",!a.flagConfirm&&a.passwordAgain.dirty),s.xp6(1),s.Q6J("ngIf",a.passsword_invalid),s.xp6(6),s.s9C("label",s.lcZ(44,31,"newObject.form.btnSubmit"))}}const Q=function(r,i){return{"pi-chevron-right":r,"pi-chevron-down":i}},D=[{path:"",component:(()=>{class r{constructor(a,o,e,f,R){this.fb=a,this.loginService=o,this.messageService=e,this.breadcrumbService=f,this.languageService=R,this.show=!1,this.show2=!1,this.flagConfirm=!1,this.passError=!1,this.subscribes=[],this.passsword_invalid=!1,this.createForm(),this.add_breadcrumb()}ngOnDestroy(){this.subscribes.forEach(a=>{a.unsubscribe()})}ngOnInit(){}add_breadcrumb(){var a=this;return(0,g.Z)(function*(){a.breadcrumbService.setItems([{label:"ROA"},{label:yield a.languageService.translate.get("menu.settings").toPromise()},{label:yield a.languageService.translate.get("menu.sideMenu.security").toPromise(),routerLink:["/settings/security"]}])})()}createForm(){this.angForm=this.fb.group({passwordOld:[this.oldPassword,[n.kI.required]],passwordNew:[{value:this.newPassword,disabled:!1},[n.kI.required,n.kI.pattern("(?=\\D*\\d)(?=[^a-z]*[a-z])(?=[^A-Z]*[A-Z]).{8,30}")]],passwordAgain:[{value:this.againPassword,disabled:!0},[n.kI.required]]})}sendPasswordRest(){var a=this;return(0,g.Z)(function*(){if(a.angForm.valid){if(a.validatorPassword())return void a.showError("La contrase\xf1as no coinciden");a.oldPassword=a.angForm.get("passwordOld").value,a.newPassword=a.angForm.get("passwordNew").value,a.againPassword=a.angForm.get("passwordAgain").value,a.passwords={password:a.newPassword,password2:a.againPassword,old_password:a.oldPassword};let o=yield a.loginService.changePassword(a.passwords,a.loginService.user.id).subscribe(e=>{"Ok"==e.status&&(a.showSuccess("Contrase\xf1a actualizada"),p().fire({allowOutsideClick:!1,icon:"info",text:"Actualizando su contrase\xf1a..."}),p().showLoading(null),a.loginService.signOutPass(),p().close())},e=>{"New password cannot be the same as above."==e.error.details.password[0]&&(a.passsword_invalid=!0,a.showError("La nueva contrase\xf1a no puede ser la misma que la anterior."),a.angForm.controls.passwordNew.markAllAsTouched(),a.angForm.controls.passwordAgain.markAllAsTouched()),"Old password is not correct"==e.error.details.old_password.old_password&&(a.showError("La contrase\xf1a anterior es incorrecta"),a.passError=!0),"Password fields didn't match."==e.error.details.password[0]&&(a.showError("La contrase\xf1a nueva no coincide"),a.passError=!0),"Old password is not correct"==e?.error?.details?.old_password.old_password&&(a.showError("La contrase\xf1a actual es incorrecta"),a.passError=!0)});a.subscribes.push(o)}else a.markTouchForm()})()}showError(a){this.messageService.add({severity:"error",summary:"Error",detail:a})}showSuccess(a){this.messageService.add({severity:"success",summary:"Success",detail:a})}validatorPassword(){return this.angForm.get("passwordNew").value===this.angForm.get("passwordAgain").value?(this.flagConfirm=!0,this.passsword_invalid=!1,!1):(this.flagConfirm=!1,!0)}resetForm(){this.angForm.reset(),this.show=!1}markTouchForm(){Object.values(this.angForm.controls).forEach(a=>{a.markAsTouched()})}get passwordOld(){return this.angForm.get("passwordOld")}get passwordNew(){return this.angForm.get("passwordNew")}get passwordAgain(){return this.angForm.get("passwordAgain")}enabled_Password(){"DISABLED"===this.angForm.get("passwordAgain").status&&null!=this.angForm.get("passwordNew").value&&""!=this.angForm.get("passwordNew").value?this.angForm.controls.passwordAgain.enable():(null===this.angForm.get("passwordNew").value||void 0===this.angForm.get("passwordNew").value||""===this.angForm.get("passwordNew").value)&&this.angForm.controls.passwordAgain.disable()}static#s=this.\u0275fac=function(o){return new(o||r)(s.Y36(n.QS),s.Y36(w.r),s.Y36(l.ez),s.Y36(A.p),s.Y36(h.T))};static#a=this.\u0275cmp=s.Xpm({type:r,selectors:[["app-security"]],decls:24,vars:15,consts:[[1,"card"],[1,"p-grid"],[1,"p-col-6"],[1,"title"],["tabindex","0",1,"box","animate__animated","animate__fadeIn"],["loading","lazy","loading","lazy","src","./../../../../../../assets/img/key-Security.png",1,"imgLoad",3,"alt"],[2,"font-size","1.1em","font-weight","bold"],["pButton","",2,"width","100%",3,"label","click"],[1,"pi",3,"ngClass"],["class","p-grid",4,"ngIf"],[1,"hr1"],[1,"forms"],[1,"labelPass"],["autocomplete","off","id","loginForm",3,"formGroup","ngSubmit"],[1,"viewPass"],["id","passwordOldInput","formControlName","passwordOld","aria-describedby","passwordOld passwordOld1","type","password","pInputText","",1,"passPass",3,"type","ngClass","placeholder"],["tabindex","0","aria-label","Ver contrase\xf1a",1,"pi",3,"ngClass","click","keyup.enter"],[4,"ngIf"],["id","passwordOld1","class","p-error",4,"ngIf"],["id","passwordNew","formControlName","passwordNew","aria-describedby","password passwordNewErr passwordNew","key","","type","password","pInputText","",1,"passPass",3,"ngClass","placeholder","keypress"],["id","passwordNewAgain","formControlName","passwordAgain","aria-describedby","passwordAgain passwordOldNo passwordNewErr2","type","password","pInputText","",1,"passPass",3,"ngClass","placeholder","keyup"],["id","passwordOldNo","class","p-error",4,"ngIf"],["id","passwordNewErr2","class","p-error",4,"ngIf"],[1,"butonC"],["pButton","","pRipple","","label","Cancel","icon","pi pi-times",3,"click"],["pButton","","pRipple","","type","submit","icon","pi pi-check",3,"label"],["id","passwordOld","class","p-error",4,"ngIf"],["id","passwordOld",1,"p-error"],["id","passwordOld1",1,"p-error"],["id","passwordNew ","class","p-error",4,"ngIf"],["id","password","class","p-error",4,"ngIf"],["id","passwordNewErr","class","p-error",4,"ngIf"],["id","passwordNew ",1,"p-error"],["id","password",1,"p-error"],[1,"p-pl-2","p-ml-2","p-mt-0",2,"line-height","1.5"],["id","passwordNewErr",1,"p-error"],["id","passwordAgain ","class","p-error",4,"ngIf"],["id","passwordAgain ",1,"p-error"],["id","passwordOldNo",1,"p-error"],["id","passwordNewErr2",1,"p-error"]],template:function(o,e){1&o&&(s._UZ(0,"p-toast"),s.TgZ(1,"div",0)(2,"div",1)(3,"div",2)(4,"h2",3),s._uU(5),s.ALo(6,"translate"),s.qZA()(),s.TgZ(7,"div",2)(8,"div",4)(9,"figure"),s._UZ(10,"img",5),s.qZA()()(),s.TgZ(11,"div",2)(12,"label",3)(13,"p",6),s._uU(14),s.ALo(15,"translate"),s.qZA()()(),s.TgZ(16,"div",2)(17,"button",7),s.NdJ("click",function(){return e.show=!e.show}),s.ALo(18,"translate"),s.TgZ(19,"i",8),s._uU(20," \xa0"),s.qZA()()()(),s._UZ(21,"p-toast"),s.YNc(22,q,45,42,"div",9),s._UZ(23,"div",10),s.qZA()),2&o&&(s.xp6(5),s.Oqu(s.lcZ(6,6,"security.titlePass")),s.xp6(5),s.Q6J("alt","Imagen referente a cambio de contrase\xf1a"),s.xp6(4),s.Oqu(s.lcZ(15,8,"login.labelPassword")),s.xp6(3),s.s9C("label",s.lcZ(18,10,"security.changePass")),s.xp6(2),s.Q6J("ngClass",s.WLB(12,Q,!e.show,e.show)),s.xp6(3),s.Q6J("ngIf",e.show))},dependencies:[d.mk,d.O5,n._Y,n.Fj,n.JJ,n.JL,_.Hq,y.o,x.H,C.FN,n.sg,n.u,b.X$],styles:[".imgLoad[_ngcontent-%COMP%]{width:250px;height:150px}.title[_ngcontent-%COMP%]{text-align:justify}.card[_ngcontent-%COMP%]{box-shadow:1px 1px 5px #00000080;border-radius:10px}.pi[_ngcontent-%COMP%]{padding:0 20px}.p-col-6[_ngcontent-%COMP%]{overflow:hidden}.hr1[_ngcontent-%COMP%]{height:0px;padding:0;margin:5px auto 0;box-shadow:0 0 2px 1px #b1b1b1}.two[_ngcontent-%COMP%]{text-align:end}.labelPass[_ngcontent-%COMP%]{padding:10px}.passPass[_ngcontent-%COMP%]{width:100%}.viewPass[_ngcontent-%COMP%]{position:relative}.viewPass[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{position:absolute;top:8px;right:10px;padding:5px;cursor:pointer}"]})}return r})(),data:{breadcrumb:null}}];let Y=(()=>{class r{static#s=this.\u0275fac=function(o){return new(o||r)};static#a=this.\u0275mod=s.oAB({type:r});static#r=this.\u0275inj=s.cJS({imports:[u.Bz.forChild(D),u.Bz]})}return r})();var B=t(3807),K=t(380);let j=(()=>{class r{static#s=this.\u0275fac=function(o){return new(o||r)};static#a=this.\u0275mod=s.oAB({type:r});static#r=this.\u0275inj=s.cJS({imports:[d.ez,Y,B.K,K.m,n.UX]})}return r})()}}]);